<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DGI Member Login · Delta Gamma Iota</title>

  <link rel="stylesheet" href="css/styles.css" />

  <style>
    body {
      background: #f5f2f2;
    }

    /* LOGIN CARD */
    .login-box {
      max-width: 380px;
      margin: 3rem auto 4rem;
      background: #ffffff;
      padding: 2.25rem 2rem;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.14);
      text-align: center;
      border-top: 6px solid #7A0E19;
    }

    .crest-login {
      width: 140px;
      margin: 0 auto 1rem;
      filter: drop-shadow(0 0 6px rgba(0,0,0,0.25));
    }

    .login-title {
      font-size: 1.6rem;
      font-weight: 800;
      color: #7A0E19;
      margin-bottom: 4px;
    }

    .login-subtitle {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 18px;
    }

    .chapter-passcode-box {
      margin-bottom: 18px;
    }

    #chapter-passcode {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 8px;
      font-size: 0.95rem;
    }

    #submit-passcode {
      width: 100%;
      padding: 10px;
      background: #7A0E19;
      border: none;
      color: white;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      margin-bottom: 6px;
    }

    #submit-passcode:hover {
      background: #5a0a13;
    }

    .error-msg {
      color: #b30000;
      font-size: 0.9rem;
      margin-top: 4px;
    }

    .footer-spacer {
      height: 40px;
    }

    /* POST-PASSCODE SECTION */
    .post-passcode-box {
      margin-top: 1.5rem;
      text-align: left;
      font-size: 0.9rem;
    }

    .post-passcode-box h3 {
      font-size: 1.05rem;
      margin-bottom: 0.4rem;
      color: #7A0E19;
      font-weight: 700;
    }

    .post-passcode-box p {
      margin-bottom: 0.6rem;
      color: #444;
    }

    .login-existing-btn {
      width: 100%;
      padding: 10px;
      margin: 0.5rem 0 1rem;
      background: #222;
      color: #fff;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      text-align: center;
    }

    .login-existing-btn:hover {
      background: #000;
    }

    .signup-link-wrapper {
      margin-top: 0.75rem;
      text-align: center;
    }

    .signup-link-wrapper a {
      color: #7A0E19;
      font-weight: 600;
      font-size: 0.97rem;
      text-decoration: underline;
    }

    .signup-link-wrapper a:hover {
      color: #5a0a13;
    }

    .signup-link-wrapper .note {
      font-size: 0.8rem;
      color: #666;
      margin-top: 0.25rem;
    }

    /* IN-APP BROWSER WARNING (FB/IG/Snap/Etc.) */
    .inapp-warning {
      display: none;
      background: #fff3cd;
      border: 1px solid #ffeeba;
      color: #664d03;
      border-radius: 12px;
      padding: 12px 12px;
      margin: 0 0 14px;
      text-align: left;
      font-size: 0.92rem;
      line-height: 1.4;
    }

    .inapp-warning strong {
      display: block;
      margin-bottom: 6px;
    }

    .open-browser-btn {
      width: 100%;
      padding: 10px;
      background: #7A0E19;
      border: none;
      color: #fff;
      border-radius: 6px;
      font-size: 0.95rem;
      cursor: pointer;
      margin-top: 10px;
    }

    .open-browser-btn:hover {
      background: #5a0a13;
    }

    .inapp-tip {
      margin-top: 8px;
      font-size: 0.82rem;
      color: #5c4a00;
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="top-bar">
      <span>1965</span>
      <span>1998</span>
    </div>

    <div class="header-main">
      <div class="greek-letters">
        <span>Δ</span><span>Γ</span><span>Ι</span>
      </div>
      <div class="chapter-name">
        <span>DELTA</span><span>GAMMA</span><span>IOTA</span>
      </div>
    </div>

    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>

    <nav id="main-nav" class="main-nav">
      <a href="index.html">Home</a>
      <a href="cardinal-beliefs.html">Beliefs</a>
      <a href="philanthropy.html">Philanthropy</a>
      <a href="community-service.html">Community Service</a>
      <a href="executive-council.html">Executive Council</a>
      <a href="shop.html">Shop</a>
      <a href="dues-donations.html">Dues &amp; Donations</a>
      <a href="login.html" class="active">Login</a>
    </nav>
  </header>

  <!-- LOGIN CONTENT -->
  <main>
    <div class="login-box">

      <!-- In-app browser warning -->
      <div id="inapp-warning" class="inapp-warning">
        <strong>Login may not work inside Facebook / Snapchat.</strong>
        Please open this page in your device browser (Safari/Chrome) to sign in.
        <button id="open-browser-btn" class="open-browser-btn">Open in Browser</button>
        <div class="inapp-tip">
          iPhone: tap the share icon → “Open in Safari”.<br>
          Android: tap ⋮ menu → “Open in Chrome”.
        </div>
      </div>

      <!-- Crest -->
      <img src="assets/crest.png" alt="Delta Gamma Iota Crest" class="crest-login" />

      <div class="login-title">Member Login</div>
      <p class="login-subtitle">
        Active Members &amp; DGI Alumni Only
      </p>

      <!-- CHAPTER PASSCODE -->
      <div id="passcode-section" class="chapter-passcode-box">
        <input id="chapter-passcode" type="password" placeholder="Chapter Passcode" />
        <button id="submit-passcode">Continue</button>
        <div id="passcode-error" class="error-msg" style="display:none;">
          Incorrect chapter passcode.
        </div>
      </div>

      <!-- AFTER PASSCODE: EXISTING LOGIN + SIGN UP LINK -->
      <div id="post-passcode-section" class="post-passcode-box" style="display:none;">

        <h3>Welcome, Brother</h3>
        <p>
          If you already have a DGI member account, log in below.<br>
          If you need an account, click "continue with Google" to submit your information automatically.
        </p>

        <!-- Existing account login -->
        <button id="existing-login-btn" class="login-existing-btn">
          Log In or Continue with Google
        </button>

        <!-- SIGN UP LINK -->
        <div class="signup-link-wrapper">
          <a
            href="https://docs.google.com/forms/d/e/1FAIpQLScAcwwaa_5NQX4GKeKEzwabr8elmOIHJH068tpcc9-npfXN2A/viewform?usp=sharing"
            target="_blank"
          >
            Sign Up (Request a Member Account without Google)
          </a>
          <div class="note">
            Opens a secure form to request access. An officer will create your login and send details.
          </div>
        </div>

      </div>

    </div>

    <div class="footer-spacer"></div>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="footer-inner">

      <div class="footer-title">Contact Us</div>

      <div class="footer-contact">

        <a href="mailto:deltagammaiota2@gmail.com">
          <img src="assets/mail.png" class="icon" alt="Email Icon">
          deltagammaiota2@gmail.com
        </a>

        <a href="https://www.instagram.com/deltagammaiota" target="_blank">
          <img src="assets/instagram.webp" class="icon" alt="Instagram Icon">
          Instagram
        </a>

        <a href="https://www.linkedin.com/company/delta-gamma-iota/" target="_blank">
          <img src="assets/linkedin.webp" class="icon" alt="LinkedIn Icon">
          LinkedIn
        </a>

      </div>

      <div class="footer-copy">
        © 2025 Delta Gamma Iota — All Rights Reserved
      </div>

    </div>
  </footer>

  <!-- AUTH0 REDIRECT + PASSCODE LOGIC -->
  <script>
    const AUTH0_DOMAIN    = "dev-vrv7ebflsu4wba1z.us.auth0.com";
    const AUTH0_CLIENT_ID = "oh3uJuWWaU7CMQYLLtY0I9lDxIQyRKRu";
    const REDIRECT_URI    = "https://bsudeltagammaiota.netlify.app/members/dashboard.html";

    const PASSCODE = "1965"; // chapter passcode

    function startAuth0Redirect() {
      const authUrl =
        "https://" + AUTH0_DOMAIN + "/authorize" +
        "?response_type=" + encodeURIComponent("token") +
        "&client_id="     + encodeURIComponent(AUTH0_CLIENT_ID) +
        "&redirect_uri="  + encodeURIComponent(REDIRECT_URI) +
        "&scope="         + encodeURIComponent("openid profile email") +
        "&prompt="        + encodeURIComponent("login") +
        "&connection="    + encodeURIComponent("google-oauth2"); // forces Google login

      window.location.href = authUrl;
    }

    document.getElementById("submit-passcode").onclick = function () {
      const entered = document.getElementById("chapter-passcode").value.trim();

      if (entered === PASSCODE) {
        document.getElementById("passcode-error").style.display = "none";
        document.getElementById("passcode-section").style.display = "none";
        document.getElementById("post-passcode-section").style.display = "block";
      } else {
        document.getElementById("passcode-error").style.display = "block";
      }
    };

    document.getElementById("existing-login-btn").onclick = function () {
      startAuth0Redirect();
    };

    function toggleMobileMenu() {
      document.getElementById('main-nav').classList.toggle('open');
    }

    // Detect in-app browsers (FB/IG/Snap/Etc.) and show the warning
    (function () {
      const ua = navigator.userAgent || navigator.vendor || window.opera;

      const isFacebook = /FBAN|FBAV|Facebook|FB_IAB/i.test(ua);
      const isInstagram = /Instagram/i.test(ua);
      const isSnapchat = /Snapchat/i.test(ua);
      const isGenericWebView =
        (/(iPhone|iPad|iPod).*AppleWebKit/i.test(ua) && !/Safari/i.test(ua)) ||
        (/\bwv\b/.test(ua) || /Android.*Version\/\d+\.\d+/i.test(ua));

      const isInApp = isFacebook || isInstagram || isSnapchat || isGenericWebView;

      const warn = document.getElementById("inapp-warning");
      const openBtn = document.getElementById("open-browser-btn");

      if (isInApp && warn) {
        warn.style.display = "block";
      }

      if (openBtn) {
        openBtn.addEventListener("click", function () {
          const url = window.location.href;

          // Best effort to break out of some Android webviews:
          window.location.href = url;

          // Also try opening a new tab if allowed:
          setTimeout(() => {
            window.open(url, "_blank", "noopener,noreferrer");
          }, 200);
        });
      }
    })();
  </script>

</body>
</html>
